<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>API | Microclimate.jl</title>
    <meta name="description" content="Documentation for Microclimate.jl">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/Microclimate.jl/dev/assets/style.bTg2JPL4.css" as="style">
    <link rel="preload stylesheet" href="/Microclimate.jl/dev/vp-icons.css" as="style">
    
    <script type="module" src="/Microclimate.jl/dev/assets/app.uLOz6Gtr.js"></script>
    <link rel="preload" href="/Microclimate.jl/dev/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Microclimate.jl/dev/assets/chunks/theme.BrNhcMoa.js">
    <link rel="modulepreload" href="/Microclimate.jl/dev/assets/chunks/framework.Do0B6q4D.js">
    <link rel="modulepreload" href="/Microclimate.jl/dev/assets/api.md.RL7H5e8b.lean.js">
    <script src="/Microclimate.jl/versions.js"></script>
    <script src="/Microclimate.jl/dev/siteinfo.js"></script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Microclimate.jl/dev/" data-v-0f4f798b><!--[--><!--]--><!----><span data-v-0f4f798b>Microclimate.jl</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/BiophysicalEcology/Microclimate.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/BiophysicalEcology/Microclimate.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Microclimate_jl_dev_api" data-v-83890dd9><div><h1 id="API" tabindex="-1">API <a class="header-anchor" href="#API" aria-label="Permalink to &quot;API {#API}&quot;">â€‹</a></h1><details class="jldocstring custom-block" open><summary><a id="Microclimate.MicroProblem" href="#Microclimate.MicroProblem"><span class="jlbinding">Microclimate.MicroProblem</span></a> <span class="VPBadge info jlObjectType jlType"><!--[-->Type<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">MicroProblem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Simulates soil and microclimate dynamics over multiple days.</p><p><strong>Overview generated by ChatGPT</strong></p><ul><li><p>Interpolates daily min/max weather (temperature, wind, humidity, cloud) to hourly steps.</p></li><li><p>Solves the soil energy balance using an ODE each hour.</p></li><li><p>Optionally simulates soil moisture (<code>runmoist=true</code>).</p></li><li><p>Returns detailed outputs for soil, air, radiation, and water balance.</p></li></ul><p><strong>Hourly Weather Interpolation</strong></p><ul><li><p>Daily min/max values are interpolated to 24-hour vectors (e.g. <code>TAIRs</code>).</p></li><li><p>Matches the Fortran/R approach where an extra hour smooths interpolation.</p></li></ul><p><strong>Soil Layer Setup</strong></p><ul><li><p><code>numnodes_a</code>: number of nodes for temperature output.</p></li><li><p><code>numnodes_b</code>: expanded nodes for moisture (<code>numnodes_a * 2 - 2</code>).</p></li><li><p>Initializes temperature (<code>Î¸_soil0_a</code>) and moisture (<code>Î¸_soil0_b</code>).</p></li><li><p>Tracks water phase transitions in <code>Î£phase</code>.</p></li></ul><p><strong>Solar Radiation</strong></p><ul><li><p><code>solar_radiation</code> computes clear-sky radiation.</p></li><li><p>Zenith angles capped at 90Â°.</p></li><li><p>Clouds adjust radiation with <code>cloud_adjust_radiation</code>.</p></li></ul><p><strong>Time Loop</strong></p><ul><li><p>Outer loop: days.</p></li><li><p>Inner loop: hours.</p></li><li><p>Supports spin-up or multi-iteration (<code>iterate_day</code>).</p></li><li><p>Each hour:</p><ul><li><p><code>soil_energy_balance!</code> updates temperature.</p></li><li><p><code>get_soil_water_balance</code> updates moisture (optional).</p></li><li><p>Soil properties (<code>bulk_thermal_conductivity</code>, <code>bulk_heat_capacity</code>, <code>bulk_density</code>) updated.</p></li><li><p>Sky temperature computed with <code>longwave_radiation</code>.</p></li></ul></li></ul><p><strong>Profiles</strong></p><ul><li><p>After all days, computes air, wind, humidity profiles via <code>atmospheric_surface_profile</code>.</p></li><li><p>Results are &quot;flipped&quot; into vectors with <code>flip2vectors</code>.</p></li></ul><p><strong>Return Values</strong></p><p>Returns a named tuple containing:</p><ul><li><p>Air/wind/RH profiles</p></li><li><p>Cloud cover and solar radiation</p></li><li><p>Soil temperature, moisture, water potential, RH</p></li><li><p>Soil thermal properties and bulk density</p></li><li><p>Surface water pools</p></li><li><p><code>solar_radiation_out</code> and <code>profile_out</code> for detailed internals</p></li></ul><p><strong>Notes</strong></p><ul><li><p><strong>Units</strong>: Uses <code>Unitful.jl</code>. Ensure all functions preserve units.</p></li><li><p><strong>Memory</strong>: Large arrays (<code>T_soils</code>, <code>Î¸_soils</code>):verbose set showmode? may be heavy for long runs.</p></li><li><p><strong>Interpolation</strong>: Extra 25th hour is correct but needs careful indexing.</p></li><li><p><strong>Phase tranitions</strong>: Applied hourly; check <code>Î£phase</code> across multi-day runs.</p></li><li><p><strong>Moisture logic</strong>: Updates depend on <code>i == 1</code> or <code>i &lt; length(hours)</code>; confirm matches Fortran/R logic.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/simulation.jl#L1-L66" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.atmospheric_surface_profile-Tuple{}" href="#Microclimate.atmospheric_surface_profile-Tuple{}"><span class="jlbinding">Microclimate.atmospheric_surface_profile</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">atmospheric_surface_profile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; kwargs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute vertical profiles of wind speed, air temperature, and relative humidity in the atmospheric surface layer, using Moninâ€“Obukhov similarity theory (MOST).</p><p>This function reproduces the subroutine in <code>MICRO.f/get_profile.R</code> from <strong>NicheMapR</strong>, ported to Julia. It calculates the microclimate profiles above the ground (or canopy) at specified heights, based on measured values at a reference height and computed or measured soil surface temperature, together with surface roughness parameters. Zenith angle and a maximum allowed surface temperature are used to assess whether conditions are stable or unstable.</p><p><strong>Keyword Arguments</strong></p><ul><li><p><code>z0::Quantity=0.004u&quot;m&quot;</code>: roughness length (surface aerodynamic roughness).</p></li><li><p><code>karman_constant::Float64=0.4</code>: von KÃ¡rmÃ¡n constant.</p></li><li><p>`dyer_constant::Float=16, coefficient from Dyer and Hicks for Î¦_m (momentum), Î³</p></li><li><p><code>heights::Vector{Quantity}</code>: Requested heights above the surface, the last being the reference height.</p></li><li><p><code>reference_temperature::Quantity=27.78u&quot;Â°C&quot;</code>: Air temperature at the reference height.</p></li><li><p><code>reference_wind_speed::Quantity=2.75u&quot;m/s&quot;</code>: Wind speed at the reference height.</p></li><li><p><code>relative_humidity::Float64=49.0</code>: Relative humidity at the reference height (fractional).</p></li><li><p><code>surface_temperature::Quantity=48.59u&quot;Â°C&quot;</code>: Soil or surface temperature.</p></li><li><p><code>zenith_angle::Quantity=21.5u&quot;Â°&quot;</code>: Solar zenith angle.</p></li><li><p><code>elevation::Quantity=0.0u&quot;m&quot;</code>: Elevation above sea level.</p></li></ul><p><strong>Returns</strong></p><p>Named tuple with fields:</p><ul><li><p><code>wind_speed</code>: Wind speed profile at each height (<code>m/s</code>).</p></li><li><p><code>air_temperature</code>: Air temperature profile at each height (<code>K</code>).</p></li><li><p><code>relative_humidity</code>: Relative humidity (fractional) at each height.</p></li><li><p><code>Q_convection</code>: Convective heat flux (<code>W/mÂ²</code>).</p></li><li><p><code>u_star</code>: Friction velocity (<code>m/s</code>).</p></li></ul><p><strong>Notes</strong></p><ul><li><p>Stability corrections use the <strong>Busingerâ€“Dyer</strong> formulations for unstable conditions.</p></li><li><p>The Moninâ€“Obukhov length is estimated iteratively through <code>calc_Obukhov_length</code>.</p></li><li><p>Two broad options for aerodynamic roughness calculations are available: Campbell &amp; Norman&#39;s (1998) approach</p></li></ul><p>that handles canopy displacement, invoked if <code>zh &gt; 0</code> and otherwise</p><ul><li><p>When <code>zh &gt; 0</code>, canopy displacement is considered in the profile calculation.</p></li><li><p>zh and d0 for Campbell and Norman air temperature/wind speed profile (0.6 * canopy height in m if unknown</p></li></ul><table tabindex="0"><thead><tr><th style="text-align:right;">Condition</th><th style="text-align:right;">Wind profile</th><th style="text-align:right;">Temperature profile</th></tr></thead><tbody><tr><td style="text-align:right;"><code>zh &gt; 0</code> + neutral/hot</td><td style="text-align:right;">log-law</td><td style="text-align:right;">log between <code>z</code> and <code>zh</code></td></tr><tr><td style="text-align:right;"><code>zh &gt; 0</code> + unstable/stable</td><td style="text-align:right;">log-law with <code>calc_Ïˆ_m</code> correction</td><td style="text-align:right;">log with displacement/<code>zh</code></td></tr><tr><td style="text-align:right;"><code>zh == 0</code> + neutral/hot</td><td style="text-align:right;">log-law</td><td style="text-align:right;">weighted by bulk/sublayer Stanton numbers</td></tr><tr><td style="text-align:right;"><code>zh == 0</code> + unstable/stable</td><td style="text-align:right;">log-law with <code>calc_Ïˆ_m</code> correction</td><td style="text-align:right;">full Moninâ€“Obukhov profile via <code>calc_Obukhov_length</code></td></tr></tbody></table><ul><li>Relative humidity profiles are estimated from vapor pressure at each height.</li></ul><p><strong>References</strong></p><ul><li><p>Businger, J. A., Wyngaard, J. C., Izumi, Y., &amp; Bradley, E. F. (1971). Fluxâ€“profile relationships in the atmospheric surface layer. <em>Journal of the Atmospheric Sciences</em>, 28(2), 181â€“189.</p></li><li><p>Dyer, A. J. (1974). A review of fluxâ€“profile relationships. <em>Boundary-Layer Meteorology</em>, 7(3), 363â€“372.</p></li><li><p>Kearney, M. R., et al. (2020). NicheMapR: an R package for microclimate and biophysical modeling. <em>Ecography</em>, 43, 1â€“14.</p></li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">profile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> atmospheric_surface_profile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reference_temperature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Â°C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    reference_wind_speed </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;m/s&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    relative_humidity </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    surface_temperature </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 35</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Â°C&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    zenith_angle </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 45</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Â°&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">profile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">air_temperature  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># vertical profile of air temperatures</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">profile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wind_speed       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># vertical profile of wind speeds</span></span></code></pre></div><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L10-L82" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.bulk_stanton-Tuple{Any, Any, Any}" href="#Microclimate.bulk_stanton-Tuple{Any, Any, Any}"><span class="jlbinding">Microclimate.bulk_stanton</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bulk_stanton</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(log_z_ratio, z, L_Obukhov)</span></span></code></pre></div><p>Compute the bulk Stanton number for unstable conditions.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L312-L316" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.bulk_stanton-Tuple{Any}" href="#Microclimate.bulk_stanton-Tuple{Any}"><span class="jlbinding">Microclimate.bulk_stanton</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">bulk_stanton</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(log_z_ratio)</span></span></code></pre></div><p>Compute the bulk Stanton number for stable conditions.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L303-L307" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_Obukhov_length-NTuple{10, Any}" href="#Microclimate.calc_Obukhov_length-NTuple{10, Any}"><span class="jlbinding">Microclimate.calc_Obukhov_length</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_Obukhov_length</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T_ref_height, T_surface, v_ref_height, z, z0, ÏcpTÎºg, Îº, log_z_ratio, Î”T, Ï_cp, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                     Î³</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, max_iter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tol</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1e-2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Iteratively solve for Monin-Obukhov length and convective heat flux.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L402-L407" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_convection-Tuple{}" href="#Microclimate.calc_convection-Tuple{}"><span class="jlbinding">Microclimate.calc_convection</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_convection</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; u_star, log_z_ratio, Î”T, Ï_cp, z0)</span></span></code></pre></div><p>Calculate the convective heat flux (sensible heat exchange between surface and air).</p><p><strong>Arguments</strong></p><ul><li><p><code>u_star::Quantity{&lt;:Real,ğ‹/ğ“}</code>: Friction velocity (e.g. <code>m/s</code>, <code>cm/min</code>).</p></li><li><p><code>log_z_ratio::Real</code>: Precomputed logarithmic height ratio, typically <code>log(z/z0 + 1.0)</code>.</p></li><li><p><code>Î”T::Quantity{&lt;:Real,Î˜}</code>: Temperature difference between reference air and surface (Kelvin).</p></li><li><p><code>Ï_cp::Quantity{&lt;:Real,(ğŒ*ğ‹^-1*ğ“^-2)}</code>: Volumetric heat capacity of air (e.g. <code>J/mÂ³/K</code>, <code>cal/cmÂ³/K</code>).</p></li><li><p><code>z0::Quantity{&lt;:Real,ğ‹}</code>: Surface roughness length (length).</p></li></ul><p><strong>Returns</strong></p><ul><li>Convective heat flux as <code>Quantity{&lt;:Real,(ğŒ*ğ“^-3)}</code> (e.g. <code>W/mÂ²</code>, <code>cal/min/cmÂ²</code>).</li></ul><p>Uses bulk and sublayer Stanton numbers to account for turbulence near the surface.</p><p><strong>See also</strong></p><p><a href="/Microclimate.jl/dev/api#Microclimate.calc_u_star-Tuple{}"><code>calc_u_star</code></a>, <a href="/Microclimate.jl/dev/api#Microclimate.calc_wind-NTuple{5, Any}"><code>calc_wind</code></a>, <a href="/Microclimate.jl/dev/api#Microclimate.sublayer_stanton-Tuple{Any, Any}"><code>sublayer_stanton</code></a>, <a href="/Microclimate.jl/dev/api#Microclimate.bulk_stanton-Tuple{Any, Any, Any}"><code>bulk_stanton</code></a>, <a href="/Microclimate.jl/dev/api#Microclimate.convective_flux-NTuple{5, Any}"><code>convective_flux</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L258-L277" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_u_star-Tuple{}" href="#Microclimate.calc_u_star-Tuple{}"><span class="jlbinding">Microclimate.calc_u_star</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_u_star</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(; reference_wind_speed, log_z_ratio, Îº</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute the friction velocity (u*) from a reference wind speed using the logarithmic wind profile.</p><p><strong>Arguments</strong></p><ul><li><p><code>reference_wind_speed::Quantity{&lt;:Real,ğ‹/ğ“}</code>: Wind speed at the reference height (e.g. <code>m/s</code>, <code>cm/min</code>).</p></li><li><p><code>log_z_ratio::Real</code>: Precomputed log height ratio, typically <code>log(z/z0 + 1.0)</code>.</p></li><li><p><code>Îº::Real</code>: von KÃ¡rmÃ¡n constant (default = 0.4).</p></li></ul><p><strong>Returns</strong></p><ul><li>Friction velocity <code>u_star::Quantity{&lt;:Real,ğ‹/ğ“}</code>.</li></ul><p><strong>See also</strong></p><p><a href="/Microclimate.jl/dev/api#Microclimate.calc_convection-Tuple{}"><code>calc_convection</code></a>, <a href="/Microclimate.jl/dev/api#Microclimate.calc_wind-NTuple{5, Any}"><code>calc_wind</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L213-L229" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_wind-NTuple{5, Any}" href="#Microclimate.calc_wind-NTuple{5, Any}"><span class="jlbinding">Microclimate.calc_wind</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_wind</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(z, z0, Îº, u_star, b)</span></span></code></pre></div><p>Calculate wind speed at height <code>z</code> using the logarithmic wind profile.</p><p><strong>Arguments</strong></p><ul><li><p><code>z::Quantity{&lt;:Real,ğ‹}</code>: Height above the surface (e.g. <code>m</code>, <code>cm</code>).</p></li><li><p><code>z0::Quantity{&lt;:Real,ğ‹}</code>: Roughness length (e.g. <code>m</code>, <code>cm</code>).</p></li><li><p><code>Îº::Real</code>: von KÃ¡rmÃ¡n constant.</p></li><li><p><code>u_star::Quantity{&lt;:Real,ğ‹/ğ“}</code>: Friction velocity.</p></li><li><p><code>b::Real</code>: Offset term (e.g. <code>1.0</code> for neutral stability, or stability correction).</p></li></ul><p><strong>Returns</strong></p><ul><li>Wind speed at height <code>z::Quantity{&lt;:Real,ğ‹/ğ“}</code>.</li></ul><p><strong>See also</strong></p><p><a href="/Microclimate.jl/dev/api#Microclimate.calc_u_star-Tuple{}"><code>calc_u_star</code></a>, <a href="/Microclimate.jl/dev/api#Microclimate.calc_convection-Tuple{}"><code>calc_convection</code></a></p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L235-L252" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_Ï_cp-NTuple{4, Any}" href="#Microclimate.calc_Ï_cp-NTuple{4, Any}"><span class="jlbinding">Microclimate.calc_Ï_cp</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_Ï_cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T_mean, elevation, relative_humidity)</span></span></code></pre></div><p>Compute the volumetric heat capacity of moist air (ÏÂ·câ‚š) given temperature, elevation, and relative humidity.</p><p><strong>Arguments</strong></p><ul><li><p><code>T_mean</code>: Mean air temperature (<code>Unitful.Temperature</code>), in Kelvin.</p></li><li><p><code>elevation</code>: Elevation above sea level (with units of length).</p></li><li><p><code>relative_humidity</code>: Relative humidity (fraction between 0 and 1).</p></li></ul><p><strong>Returns</strong></p><ul><li>Volumetric heat capacity (<code>cal / (cmÂ³Â·K)</code>).</li></ul><p>Uses <code>dry_air_properties</code> to compute air density (Ï) and <code>wet_air_properties</code> to compute specific heat capacity (câ‚š).</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L188-L204" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_Ï_cp-Tuple{Any}" href="#Microclimate.calc_Ï_cp-Tuple{Any}"><span class="jlbinding">Microclimate.calc_Ï_cp</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_Ï_cp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(T_mean)</span></span></code></pre></div><p>Compute the volumetric heat capacity of air (ÏÂ·câ‚š) as a function of mean temperature.</p><p><strong>Arguments</strong></p><ul><li><code>T_mean</code>: Mean air temperature (<code>Unitful.Temperature</code>), in Kelvin.</li></ul><p><strong>Returns</strong></p><ul><li>Volumetric heat capacity (<code>cal / (cmÂ³Â·K)</code>).</li></ul><p>This is a simplified empirical regression based only on temperature, without accounting for moisture or elevation effects.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L170-L183" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_Ï†_m-Tuple{Any, Any, Any}" href="#Microclimate.calc_Ï†_m-Tuple{Any, Any, Any}"><span class="jlbinding">Microclimate.calc_Ï†_m</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_Ï†_m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(z, Î³, L_Obukhov)</span></span></code></pre></div><p>Stability correction function Ï† for momentum in Moninâ€“Obukhov similarity theory (MOST).</p><p><strong>Arguments</strong></p><ul><li><p><code>z</code>: Height above surface (with units of length).</p></li><li><p><code>Î³</code>: Empirical constant (dimensionless, often â‰ˆ16).</p></li><li><p><code>L_Obukhov</code>: Moninâ€“Obukhov length (with units of length).</p></li></ul><p><strong>Returns</strong></p><ul><li>Dimensionless stability correction factor Ï†.</li></ul><p>This corresponds to the Busingerâ€“Dyer formulation for unstable stratification:</p><p>Ï†â‚˜ = (1 - Î³ z / L)^(1/4)</p><p><strong>References</strong></p><ul><li><p>Businger, J. A., Wyngaard, J. C., Izumi, Y., &amp; Bradley, E. F. (1971). Fluxâ€“profile relationships in the atmospheric surface layer. <em>Journal of the Atmospheric Sciences</em>, 28(2), 181â€“189.</p></li><li><p>Dyer, A. J. (1974). A review of fluxâ€“profile relationships. <em>Boundary-Layer Meteorology</em>, 7(3), 363â€“372.</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L322-L345" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_Ïˆ_h-Tuple{Any}" href="#Microclimate.calc_Ïˆ_h-Tuple{Any}"><span class="jlbinding">Microclimate.calc_Ïˆ_h</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_Ïˆ_h</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span></code></pre></div><p>Stability correction function Ïˆ_h for heat and moisture under unstable conditions, used in Moninâ€“Obukhov similarity theory.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: Dimensionless argument, typically <code>(1 - Î³ z / L)^(1/4)</code>.</li></ul><p><strong>Returns</strong></p><ul><li>Correction factor Ïˆ_h (dimensionless).</li></ul><p>This is the Busingerâ€“Dyer form for scalars:</p><p>Ïˆ_h(x) = 2 ln((1 + xÂ²) / 2)</p><p><strong>References</strong></p><ul><li><p>Businger et al. (1971).</p></li><li><p>Dyer (1974).</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L377-L396" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.calc_Ïˆ_m-Tuple{Any}" href="#Microclimate.calc_Ïˆ_m-Tuple{Any}"><span class="jlbinding">Microclimate.calc_Ïˆ_m</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">calc_Ïˆ_m</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x)</span></span></code></pre></div><p>Stability correction function Ïˆâ‚˜ for momentum under unstable atmospheric stratification, used in Moninâ€“Obukhov similarity theory.</p><p><strong>Arguments</strong></p><ul><li><code>x</code>: Dimensionless argument, typically <code>(1 - Î³ z / L)^(1/4)</code>.</li></ul><p><strong>Returns</strong></p><ul><li>Correction factor Ïˆâ‚˜ (dimensionless).</li></ul><p>This is the Busingerâ€“Dyer form for momentum:</p><p>Ïˆâ‚˜(x) = 2 ln((1 + x) / 2) + ln((1 + xÂ²) / 2) - 2 atan(x) + Ï€/2</p><p><strong>References</strong></p><ul><li><p>Businger et al. (1971).</p></li><li><p>Dyer (1974).</p></li></ul><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L352-L371" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.cloud_adjust_radiation-Tuple{Any, AbstractArray, Any, Any, AbstractArray, Any}" href="#Microclimate.cloud_adjust_radiation-Tuple{Any, AbstractArray, Any, Any, AbstractArray, Any}"><span class="jlbinding">Microclimate.cloud_adjust_radiation</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cloud_adjust_radiation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cloud, D_cs, B_cs, zenith, doy; a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.25</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, b</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, gamma</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Compute global (G), diffuse (D), and direct-beam (B) solar on a horizontal surface given cloud cover fraction <code>cloud</code> (0â€“1), clear-sky diffuse <code>D_cs</code> and direct <code>B_cs</code>, solar zenith angle <code>zenith</code> (radians), and day-of-year <code>doy</code>.</p><ul><li><p>Ã…ngstrÃ¶m scaling: G = (a + b*S) * (D_cs + B_cs), with S â‰ˆ (1 - cloud)^gamma</p></li><li><p>Diffuse fraction via Erbs (uses extraterrestrial horizontal irradiance) via a clearness index (Maxwwell 1987) which is the ratio of global to extraterrestrial irradiance on a horizontal plane</p></li></ul><p>Returns <code>(global_solar, diffuse_fraction)</code>; works with arrays but needs to not use &#39;similar&#39; if to work with scalars.</p><p>Reference Maxwell, E. L., &quot;A Quasi-Physical Model for Converting Hourly Global Horizontal to Direct Normal Insolation&quot;, Technical Report No. SERI/TR-215-3087, Golden, CO: Solar Energy Research Institute, 1987.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/radiation.jl#L69-L89" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.convective_flux-NTuple{5, Any}" href="#Microclimate.convective_flux-NTuple{5, Any}"><span class="jlbinding">Microclimate.convective_flux</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">convective_flux</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Ï_cp, Î”T, u_star, St_bulk, St_sublayer)</span></span></code></pre></div><p>Compute convective heat flux given bulk and sublayer Stanton numbers.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L284-L288" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.soil_properties!-Tuple{NamedTuple, Any}" href="#Microclimate.soil_properties!-Tuple{NamedTuple, Any}"><span class="jlbinding">Microclimate.soil_properties!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">soil_props_vector!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(buffers, soil_thermal; micro_micro_terrain, soil_temperature, soil_moisture)</span></span></code></pre></div><p>Compute soil properties for vectors of soil temperature and moisture using broadcasting.</p><p><strong>TODO these should have readable names</strong></p><p>Returns three arrays: <code>Î»_b</code>, <code>cp_b</code>, <code>Ï_b</code>.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/soil_properties.jl#L140-L147" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.soil_properties-Tuple{CampbelldeVriesSoilThermal}" href="#Microclimate.soil_properties-Tuple{CampbelldeVriesSoilThermal}"><span class="jlbinding">Microclimate.soil_properties</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">soil_properties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(soil_thermal; soil_temperature, soil_moisture, micro_terrain)</span></span></code></pre></div><p>Compute bulk soil properties â€” thermal conductivity (<code>Î»_b</code>), volumetric heat capacity (<code>cp_b</code>), and bulk density (<code>Ï_b</code>) â€” for a given soil layer.</p><p><strong>Arguments</strong></p><ul><li><code>soil_thermal::AbstractSoilThermalModel</code></li></ul><p><strong>Keywords</strong></p><ul><li><p><code>micro_terrain</code></p></li><li><p><code>soil_temperature::Quantity</code>: Soil temperature in Kelvin.</p></li><li><p><code>soil_moisture::Real</code>: Volumetric soil moisture (mÂ³/mÂ³).</p></li></ul><p><strong>Returns</strong></p><p>A named tuple <code>(Î»_b, cp_b, Ï_b)</code>:</p><ul><li><p><code>Î»_b::Quantity</code>: Bulk thermal conductivity (W/m/K)</p></li><li><p><code>cp_b::Quantity</code>: Bulk volumetric heat capacity (J/kg/K)</p></li><li><p><code>Ï_b::Quantity</code>: Bulk density (kg/mÂ³)</p></li></ul><p><strong>Theory</strong></p><p>This function calculates soil thermal properties using the Campbell &amp; Norman (1991, 1994) approach, which accounts for:</p><ol><li><p><strong>Soil composition</strong>: Soil is modeled as a mixture of mineral, water, and air fractions. Each fraction contributes to bulk properties depending on its volumetric fraction.</p></li><li><p><strong>Water content effects</strong>: The function includes a water recirculation factor (<code>f_water</code>) to model how moisture affects heat transfer.</p></li><li><p><strong>Phase-dependent conductivity</strong>: Effective thermal conductivity of soil (<code>Î»_b</code>) is computed using a generalization of de Vriesâ€™ mixing model, considering interactions between mineral, liquid, and gas components.</p></li><li><p><strong>Temperature dependence</strong>: Thermal conductivity of water and air are adjusted with temperature.</p></li><li><p><strong>Vapor transport</strong>: Small contribution from vapor diffusion is included via a finite-difference approximation of saturated vapor pressure (<code>âˆ‡x</code>).</p></li></ol><p>This method provides an accurate representation of heat transfer in variably wet soils for land surface or microclimate modeling.</p><p><strong>References</strong></p><p>Campbell, G. S., Jungbauer, J. D. Jr., Bidlake, W. R., &amp; Hungerford, R. D. (1994). Predicting the effect of temperature on soil thermal conductivity. Soil Science, 158(5), 307â€“313.</p><p>Campbell, G. S., &amp; Norman, J. M. (1998). Environmental Biophysics. Springer.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/soil_properties.jl#L1-L54" target="_blank" rel="noreferrer">source</a><!--]--></span></details><details class="jldocstring custom-block" open><summary><a id="Microclimate.sublayer_stanton-Tuple{Any, Any}" href="#Microclimate.sublayer_stanton-Tuple{Any, Any}"><span class="jlbinding">Microclimate.sublayer_stanton</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sublayer_stanton</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(z0, u_star)</span></span></code></pre></div><p>Compute the Stanton number for the viscous sublayer.</p><span class="VPBadge info source-link"><!--[--><a href="https://github.com/BiophysicalEcology/Microclimate.jl/blob/b92ef69ae20ba1da7dc6b4cc89ecf6885bb17e3d/src/boundary_layer.jl#L294-L298" target="_blank" rel="noreferrer">source</a><!--]--></span></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><div class="edit-info" data-v-4f9813fa><div class="edit-link" data-v-4f9813fa><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/BiophysicalEcology/Microclimate.jl/edit/main/docs/src/api.md" target="_blank" rel="noreferrer" data-v-4f9813fa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-4f9813fa></span> Edit this page<!--]--></a></div><!----></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860>Made with <a href="https://luxdl.github.io/DocumenterVitepress.jl/dev/" target="_blank"><strong>DocumenterVitepress.jl</strong></a><br></p><p class="copyright" data-v-c970a860>Â© Copyright 2025.</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"api.md\":\"RL7H5e8b\",\"index.md\":\"D6DY6yB9\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Microclimate.jl\",\"description\":\"Documentation for Microclimate.jl\",\"base\":\"/Microclimate.jl/dev/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"component\":\"VersionPicker\"}],\"sidebar\":[],\"editLink\":{\"pattern\":\"https://github.com/BiophysicalEcology/Microclimate.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/BiophysicalEcology/Microclimate.jl\"}],\"footer\":{\"message\":\"Made with <a href=\\\"https://luxdl.github.io/DocumenterVitepress.jl/dev/\\\" target=\\\"_blank\\\"><strong>DocumenterVitepress.jl</strong></a><br>\",\"copyright\":\"Â© Copyright 2025.\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>